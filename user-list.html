@extends('vue-admin.layout')

@section('main-content')
  <div class="handle-box">
      <el-button type="primary" @click="userAdd">添加用户</el-button>
  </div>
  <br/>
  <el-table
    :data="tableData"
    stripe
    border>
    style="width: 100%">
    <el-table-column
      prop="uid"
      label="ID"
      width="80">
    </el-table-column>
    <el-table-column
      label="头像">
      <template slot-scope="scope">
        <img :src="scope.row.avatar" width="70">
      </template>
    </el-table-column>
    <el-table-column
      prop="username"
      label="用户名">
    </el-table-column>
    <el-table-column
      prop="nickname"
      label="昵称">
    </el-table-column>
    <el-table-column
      prop="email"
      label="邮箱">
    </el-table-column>
    <el-table-column
      prop="role"
      label="会员等级">
    </el-table-column>
    <el-table-column
      label="状态">
      <template slot-scope="scope">
        <div v-html=" scope.row.status == 1 ? '<span class=green>正常</span>' : '<span class=red>锁定</span>'"></div>
      </template>
    </el-table-column>
    <el-table-column
      prop="accessed"
      :formatter="dateFormat"
      label="上次登录">
    </el-table-column>
    <el-table-column label="操作">
      <template slot-scope="scope">
        <el-button
          size="mini"
          type="primary"
          @click="handleEdit(scope.$index, scope.row)">编辑</el-button>
        <el-button
          size="mini"
          type="danger"
          @click="handleDelete(scope.$index, scope.row)">删除</el-button>
      </template>
    </el-table-column>
  </el-table>
@endsection

@section('footer-js')
<script src="/theme/vue-admin/assets/js/fecha.min.js"></script>
<script>
 new Vue({
     el: "#app",
     data: {
       tableData: []
     },
     mounted: function () {
       this.getUserData();
     },
     methods: {
        getUserData() {
          var vm = this;
          $.ajax({
              type: "POST",
              url: "/api/user/list", //后台程序地址
              data: this.ruleForm, //需要post的数据
              success: function(res) {
                if (res.code == 1) {
                  vm.$notify.error({
                    title: '提示',
                    message: res.msg,
                    type: 'error'
                  });
                } else {
                  vm.tableData = res.data;
                }
             }
          });
        },
        userAdd() {

        },
        handleEdit(index, row) {
          console.log(index, row);
        },
        handleDelete(index, row) {
          console.log(index, row);
        },
        dateFormat(row, column, cellValue) {
          return cellValue ? fecha.format(parseInt(cellValue*1000), 'YYYY-MM-DD HH:mm:ss') : '';
        }
     }
 });
</script>
@endsection
